<div id="extras1" class="row-fluid hide">
  <div class="span3">
    <div class="altitude">50,000 feet: Life</div>
    <div class="altitude">40,000 feet: 3-5-year Outlook</div>
    <div class="altitude">30,000 feet: 1-2 Goals</div>
    <div class="altitude">20,000 feet: Areas of Responsibility</div>
    <div class="altitude">10,000 feet: Current Projects</div>
    <div class="altitude">Runway: Current actions</div>
  </div>
  <div class="span3">
    <%= link_to "?", "#", :class => "help" %>
    <div class="altitude">
      <div class="context collect">
        <%= link_to "Collect", "/status/collect", :title => "Collect everything you can think of." %>
      </div>
      <p class="hint">Collect everything you can think of.</p>
    </div>
    <div class="altitude">
      <div class="context process">
        <%= link_to "Process", "/status/process", :title => "Decide what to do with each item in the Inbox." %>
        <p class="hint">Decide what to do with each item in the Inbox.</p>
      </div>
    </div>
    <div class="altitude">
      <div class="context organize">
        <%= link_to "Organize", "/status/organize", :title => "Organize items into the right buckets." %>
        <p class="hint">Organize by project and priority. Work from Calendar Tasks, then Trello.</p>
      </div>
    </div>
    <div class="altitude">
      <div class="context review">
        <%= link_to "Review", "/status/review", :title => "Review every day and once a week to keep the system up-to-date." %>
        <p class="hint">Review to regain context and focus, about once a week.</p>
      </div>
    </div>
    <div class="altitude">
      <div class="context do last">
        <%= link_to "Do", "/status/do", :title => "Do and make the best choices." %>
        <p class="hint">Get to work.</p>
      </div>
    </div>
  </div>
  <div class="span6">
    <%= render 'layouts/dashboard' %>
  </div>
  <div class="row-fluid">
    <div class="span12">
      <hr/>
    </div>
  </div>
</div>

<%= render 'checkins/awaiting' %>

<div class="row-fluid">
  <div class="span3">
    <h4>
      <%= icon 'hand-o-down' %>
      Pomodoro
    </h4>
    <div class="pomodoro">
      <div class="row-fluid">
        <div class="span8">
          <%= text_field_tag 'date', Time.now, :class => 'span12' %>
        </div>
        <div class="span4">
          <%= link_to raw("#{icon 'play'} Start"), "#", :class => "btn start timer" %>
          <%# icon 'pause' %>
        </div>
      </div>
    </div>

    <hr>

    <div>
      <%= render 'habits/possible' %>

      <!--
         Consider dragging and dropping these items
      -->
      File folders, Dropbox and local files

      <div>
        <div id="extras2" class="row-fluid">
          <% @labels = ["", "label-success", "label-warning", "label-important", "label-info", "label-inverse"] %>
          <%
             # accept trello color
             # return bootstrap label
             def translate_trello_card_color(string)
               case string
                 when "green"
                   "label-success"
                 when "yellow"
                   "label-warning"
                 when "orange"
                   "label-warning"
                 when "red"
                   "label-important hide"
                 when "blue"
                   "label-info"
                 when "purple"
                   "label-inverse"
               end
             end
          %>

          <% if false && true && Rails.env == 'development' %>
            <div class="span12">
              <% board = Trello::Board.find($trello_personal_board_id) %>
              <div class="board">
                <h4>
                  <%= link_to board.name, board.url, :target => "blank" %>
                </h4>

                <div class="tasks">
                  <% board.lists(:filter => "open").each do |list| %>
                    <% unless list.name == "Awaiting" %>
                      <% list.cards.each do |card| %>
                        <span class="label <%= translate_trello_card_color(card.labels.first.color) if card.labels.first %>">
                          &nbsp;
                        </span>
                        <%= link_to card.name, card.url, :alt => card.description %>
                        <%= card.due.to_date if card.due %>
                        <br>
                      <% end %>
                    <% end %>
                  <% end %>
                </div>

                <%= board.description if !board.description.empty? %>
              </div>
            </div>
          <% end %>
        </div>

      </div>

    </div>
  </div>

  <div class="span6">
    <div class="span12">
      <div class="checkins">
        <% last_checkin = nil %>
        <% Checkin.today.each do |checkin| %>
          <%= content_tag(:h5, checkin.created_at.strftime("%B %d"), :style => "text-transform:uppercase;") unless (checkin.created_at.day == (last_checkin.day rescue nil)) %>
          <%= render 'checkins/one', { checkin: checkin } %>
          <% last_checkin = checkin.created_at %>
        <% end %>
      </div>

      <hr>

      <div class="row-fluid">
        <div class="span12">
          <div class="greeting" style="margin-left: 94px;">
            <div class="row-fluid">
              <div class="span6">
                Hi <%= @settings[:user] %>,
                <br>
                Pardon, what have you been up to?
              </div>
              <div class="span6">
                <p style="text-align: right;">
                  Sincerely,
                  <br>
                  Your Lovely Nag
                </p>
              </div>
            </div>
          </div>
        </div>
        <div class="span12">
          <div class="media">
            <a class="pull-left" href="#">
              <img class="media-object" alt="64x64" style="width: 64px; height: 64px;" src="/images/avatar.png">
            </a>

            <div class="media-body">
              <%= render 'checkins/form' %>
            </div>
          </div>
        </div>
      </div>

      <hr>

      <div class="checkins">
        <% last_checkin = nil %>
        <% @latest_checkins.each do |checkin| %>
          <%= content_tag(:h5, checkin.created_at.strftime("%B %d"), :style => "text-transform:uppercase;") unless (checkin.created_at.day == (last_checkin.day rescue nil)) %>
          <%= render 'checkins/one', { checkin: checkin } %>
          <% last_checkin = checkin.created_at %>
        <% end %>
      </div>
    </div>
  </div>

  <div class="span3">
    <%= render "partials/calendar", { :entries => @entries } if @entries %>
  </div>
</div>

<script>
  $(function () {
    $("#show_helper1").click(function () {
      if ($(this).parent("li").hasClass("active") === true) {
        $(this).parent("li").removeClass("active");
      } else {
        $(this).parent("li").addClass("active");
      }
      $("#extras1").toggle();
    });

    $("#show_helper2").click(function () {
      if ($(this).parent("li").hasClass("active") === true) {
        $(this).parent("li").removeClass("active");
      } else {
        $(this).parent("li").addClass("active");
      }
      $("#awaiting").toggle();
    });
  });
</script>
